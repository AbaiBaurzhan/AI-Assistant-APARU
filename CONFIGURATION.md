# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
FASTAPI_ENV=production
LOG_LEVEL=INFO

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–∏—Å–∫–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
EMBEDDING_MODEL=BAAI/bge-m3
FAISS_INDEX_PATH=data/faiss.index
KNOWLEDGE_BASE_PATH=data/kb.jsonl

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
HOST=0.0.0.0
PORT=8000
```

## ü§ñ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–π

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `utils/greetings_config.py`

```python
# Fallback –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–ª—è —Å–ª—É—á–∞–µ–≤ —Å –Ω–∏–∑–∫–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é
FALLBACK_GREETING_RESPONSE = (
    "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –≤–∞—à–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ. "
    "–ù–∞–ø–∏—à–∏—Ç–µ —Å–≤–æ–∏ –≤–æ–ø—Ä–æ—Å. –ù–∞–ø—Ä–∏–º–µ—Ä: –ö–∞–∫–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ê–ü–ê–†–£ ?"
)

# –ü–æ—Ä–æ–≥ confidence –¥–ª—è fallback –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
FALLBACK_CONFIDENCE_THRESHOLD = 0.6

# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
STANDARD_GREETING_RESPONSE = (
    "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –≤–∞—à–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ. "
    "–ù–∞–ø–∏—à–∏—Ç–µ —Å–≤–æ–∏ –≤–æ–ø—Ä–æ—Å. –ù–∞–ø—Ä–∏–º–µ—Ä: –ö–∞–∫–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ê–ü–ê–†–£ ?"
)
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–π

```python
# –°–ø–∏—Å–æ–∫ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–π
GREETING_PATTERNS = [
    # –§–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ)
    "–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ",
    "–¥–æ–±—Ä—ã–π –¥–µ–Ω—å",
    "–¥–æ–±—Ä–æ–µ —É—Ç—Ä–æ",
    "–¥–æ–±—Ä—ã–π –≤–µ—á–µ—Ä",

    # –§–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è —Å –æ–ø–µ—á–∞—Ç–∫–∞–º–∏
    "–∑–¥—Ä–∞—Å—Ç–≤—É–π—Ç–µ",  # –ø—Ä–æ–ø—É—Å–∫ "–≤"
    "–¥–æ–±—Ä—ã–π –¥–µ–Ω",   # –ø—Ä–æ–ø—É—Å–∫ –º—è–≥–∫–æ–≥–æ –∑–Ω–∞–∫–∞

    # –ù–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
    "–ø—Ä–∏–≤–µ—Ç",
    "—Ö–∞–π",
    "—Ö–µ–ª–ª–æ",

    # –ù–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è —Å –æ–ø–µ—á–∞—Ç–∫–∞–º–∏
    "–ø—Ä–∏–≤–µ—Ç—Ç",      # —É–¥–≤–æ–µ–Ω–∏–µ "—Ç"
]
```

## üîç –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Fuzzy Matching

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `utils/fuzzy_config.py`

```python
# –ü–æ—Ä–æ–≥–∏ —Å—Ö–æ–¥—Å—Ç–≤–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–π
FORMAL_GREETING_THRESHOLD = 90    # "–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ", "–¥–æ–±—Ä—ã–π –¥–µ–Ω—å"
INFORMAL_GREETING_THRESHOLD = 85  # "–ø—Ä–∏–≤–µ—Ç", "—Ö–∞–π"
SHORT_GREETING_THRESHOLD = 80     # "–ø—Ä–∏–≤–µ—Ç", "—Ö–∞–π"
QUESTION_GREETING_THRESHOLD = 85  # "–∫–∞–∫ –¥–µ–ª–∞", "–∫–∞–∫ –ø–æ–∂–∏–≤–∞–µ—Ç–µ"
THANKS_GREETING_THRESHOLD = 85    # "—Å–ø–∞—Å–∏–±–æ", "–±–ª–∞–≥–æ–¥–∞—Ä—é"

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è fuzzy —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
MAX_FUZZY_LENGTH = 50

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è rapidfuzz
FUZZY_SCORER = "ratio"  # "ratio", "partial_ratio", "token_sort_ratio", "token_set_ratio"

# –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ fuzzy matching
ENABLE_FUZZY_CACHE = True
FUZZY_CACHE_SIZE = 1000

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ fuzzy matching
LOG_FUZZY_MATCHES = True
LOG_FUZZY_THRESHOLD = 70  # –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å—Ö–æ–¥—Å—Ç–≤–æ >= —ç—Ç–æ–≥–æ –ø–æ—Ä–æ–≥–∞
```

## üìä –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–∏—Å–∫–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

### –ü–æ—Ä–æ–≥–∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏

```python
# –í utils/search.py
HIGH_CONFIDENCE_THRESHOLD = 0.8   # –í—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å
MEDIUM_CONFIDENCE_THRESHOLD = 0.6 # –°—Ä–µ–¥–Ω—è—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å
LOW_CONFIDENCE_THRESHOLD = 0.4    # –ù–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å
```

### –õ–æ–≥–∏–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤

- **confidence ‚â• 0.8**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ç–æ—á–Ω—ã–π –æ—Ç–≤–µ—Ç
- **0.6 ‚â§ confidence < 0.8**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —É—Ç–æ—á–Ω–µ–Ω–∏–µ —Å –ø–æ—Ö–æ–∂–∏–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏
- **confidence < 0.6**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è fallback –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ

## üéØ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
# –í utils/fuzzy_greetings.py
ENABLE_FUZZY_CACHE = True
FUZZY_CACHE_SIZE = 1000

# –í utils/search.py
ENABLE_SEARCH_CACHE = True
SEARCH_CACHE_SIZE = 500
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

```python
# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
MAX_QUERY_LENGTH = 500
MAX_RESPONSE_LENGTH = 2000

# –¢–∞–π–º–∞—É—Ç—ã
SEARCH_TIMEOUT = 5.0  # —Å–µ–∫—É–Ω–¥
EMBEDDING_TIMEOUT = 10.0  # —Å–µ–∫—É–Ω–¥
```

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

```python
# –í main.py
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
```

### –§–∞–π–ª—ã –ª–æ–≥–æ–≤

- `logs/app.log` - –û—Å–Ω–æ–≤–Ω—ã–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `data/feedback.log` - –õ–æ–≥–∏ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
- `logs/greetings.log` - –õ–æ–≥–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–π
- `logs/fuzzy.log` - –õ–æ–≥–∏ fuzzy matching

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ë–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

```python
# –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–æ–≤
from utils.greetings_config import FALLBACK_CONFIDENCE_THRESHOLD
FALLBACK_CONFIDENCE_THRESHOLD = 0.7  # –ù–æ–≤—ã–π –ø–æ—Ä–æ–≥
```

### –° –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
pkill -f uvicorn
uvicorn main:app --host 0.0.0.0 --port 8000 &
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ health endpoint
curl http://localhost:8000/api/v1/health

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–π
curl -X POST "http://localhost:8000/api/v1/ask" \
  -H "Content-Type: application/json" \
  -d '{"query": "–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ"}'

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ fuzzy matching
curl -X POST "http://localhost:8000/api/v1/ask" \
  -H "Content-Type: application/json" \
  -d '{"query": "–¥–æ–±—Ä–π –¥–µ–Ω"}'
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
tail -f logs/app.log

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
htop
```
