# –ü—Ä–æ—Ü–µ—Å—Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è Excel —Ñ–∞–π–ª–∞ –≤ —Å–∏—Å—Ç–µ–º—É FAQ Assistant

## üì• –°–ø–æ—Å–æ–±—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è Excel —Ñ–∞–π–ª–∞

### 1. üñ±Ô∏è –ü—Ä–æ—Å—Ç–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ (–∑–∞–º–µ–Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ)

#### –®–∞–≥–∏:

1. **–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ Excel —Ñ–∞–π–ª** —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
2. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª** –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `data/`
3. **–ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ** –≤ `faq.xlsx`
4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É**

```bash
# 1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª
cp your_new_faq.xlsx data/faq.xlsx

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É
python build_index.py
```

### 2. üîÑ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –¥–∞–Ω–Ω—ã–º (—Å–ª–∏—è–Ω–∏–µ)

#### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª–æ–≤:

```bash
# –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
mkdir -p incoming

# –ö–æ–ø–∏—Ä—É–µ–º –Ω–æ–≤—ã–µ Excel —Ñ–∞–π–ª—ã
cp new_questions.xlsx incoming/
cp additional_faq.xlsx incoming/
```

#### –ü—Ä–æ—Ü–µ—Å—Å —Å–ª–∏—è–Ω–∏—è:

```python
# –°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–ª–∏—è–Ω–∏—è Excel —Ñ–∞–π–ª–æ–≤
import pandas as pd
from pathlib import Path

def merge_excel_files():
    # –ß–∏—Ç–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª
    existing_df = pd.read_excel('data/faq.xlsx')

    # –ß–∏—Ç–∞–µ–º –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã
    new_files = list(Path('incoming').glob('*.xlsx'))

    all_dataframes = [existing_df]

    for file in new_files:
        df = pd.read_excel(file)
        all_dataframes.append(df)

    # –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
    merged_df = pd.concat(all_dataframes, ignore_index=True)

    # –£–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
    merged_df = merged_df.drop_duplicates(subset=['question'])

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π —Ñ–∞–π–ª
    merged_df.to_excel('data/faq_merged.xlsx', index=False)

    return merged_df
```

## üîç –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ Excel —Ñ–∞–π–ª—É

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

```excel
| question                    | answer                        |
|----------------------------|-------------------------------|
| –ö–∞–∫ –∑–∞–∫–∞–∑–∞—Ç—å —Ç–∞–∫—Å–∏?        | –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –Ω–∞–∂–º–∏—Ç–µ |
| –°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç –ø–æ–µ–∑–¥–∫–∞?     | –¢–∞—Ä–∏—Ñ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è   |
| –ö–∞–∫ –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑?        | –ó–∞–∫–∞–∑ –º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ |
```

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:

- **–§–æ—Ä–º–∞—Ç**: `.xlsx` –∏–ª–∏ `.xls`
- **–ö–æ–¥–∏—Ä–æ–≤–∫–∞**: UTF-8
- **–ö–æ–ª–æ–Ω–∫–∏**: `question` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ), `answer` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- **–†–∞–∑–º–µ—Ä**: –¥–æ 10MB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫**: –¥–æ 10,000 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### –ü—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞:

```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ñ–∞–π–ª–∞
import pandas as pd

def validate_excel_file(file_path):
    try:
        df = pd.read_excel(file_path)

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏
        required_columns = ['question', 'answer']
        missing_columns = [col for col in required_columns if col not in df.columns]

        if missing_columns:
            print(f"‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫–æ–ª–æ–Ω–∫–∏: {missing_columns}")
            return False

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö
        if len(df) == 0:
            print("‚ùå –§–∞–π–ª –ø—É—Å—Ç–æ–π")
            return False

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
        empty_questions = df['question'].isna().sum()
        empty_answers = df['answer'].isna().sum()

        if empty_questions > 0 or empty_answers > 0:
            print(f"‚ö†Ô∏è –ù–∞–π–¥–µ–Ω—ã –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: –≤–æ–ø—Ä–æ—Å–æ–≤={empty_questions}, –æ—Ç–≤–µ—Ç–æ–≤={empty_answers}")

        print(f"‚úÖ –§–∞–π–ª –≤–∞–ª–∏–¥–µ–Ω: {len(df)} –∑–∞–ø–∏—Å–µ–π")
        return True

    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞: {e}")
        return False
```

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ Excel —Ñ–∞–π–ª–∞

### –≠—Ç–∞–ø 1: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–∞

```python
def read_excel_file(self, file_path: str) -> pd.DataFrame:
    # 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
    if not Path(file_path).exists():
        raise FileNotFoundError(f"–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: {file_path}")

    # 2. –ß—Ç–µ–Ω–∏–µ Excel —Ñ–∞–π–ª–∞
    df = pd.read_excel(file_path)
    logger.info(f"–ü—Ä–æ—á–∏—Ç–∞–Ω —Ñ–∞–π–ª {file_path}, —Å—Ç—Ä–æ–∫: {len(df)}")

    # 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫
    required_columns = ["question", "answer"]
    missing_columns = [col for col in required_columns if col not in df.columns]

    if missing_columns:
        raise ValueError(f"–§–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–ª–æ–Ω–∫–∏: {required_columns}")

    # 4. –£–¥–∞–ª–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫
    initial_count = len(df)
    df = df.dropna(subset=required_columns)
    final_count = len(df)

    if initial_count != final_count:
        logger.warning(f"–£–¥–∞–ª–µ–Ω–æ {initial_count - final_count} –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫")

    # 5. –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
    initial_count = len(df)
    df = df.drop_duplicates(subset=["question"])
    final_count = len(df)

    if initial_count != final_count:
        logger.warning(f"–£–¥–∞–ª–µ–Ω–æ {initial_count - final_count} –¥—É–±–ª–∏–∫–∞—Ç–æ–≤")

    return df
```

### –≠—Ç–∞–ø 2: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

```python
def normalize_text(self, text: str) -> str:
    if not isinstance(text, str):
        return ""

    # –ë–∞–∑–æ–≤–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
    text = text.strip().lower()

    # –£–¥–∞–ª—è–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
    text = " ".join(text.split())

    return text
```

### –≠—Ç–∞–ø 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤

```python
def generate_embeddings(self, texts: List[str]) -> np.ndarray:
    # 1. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤
    normalized_texts = [self.normalize_text(text) for text in texts]

    # 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
    embeddings = self.model.encode(
        normalized_texts,
        batch_size=32,           # –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
        show_progress_bar=True,  # –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
        convert_to_numpy=True,   # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ numpy
    )

    logger.info(f"–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–ª—è {len(texts)} —Ç–µ–∫—Å—Ç–æ–≤")
    return embeddings
```

### –≠—Ç–∞–ø 4: –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ FAISS –∏–Ω–¥–µ–∫—Å–∞

```python
def build_faiss_index(self, embeddings: np.ndarray) -> faiss.Index:
    # 1. –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ –¥–ª—è –∫–æ—Å–∏–Ω—É—Å–Ω–æ–≥–æ —Å—Ö–æ–¥—Å—Ç–≤–∞
    index = faiss.IndexFlatIP(embeddings.shape[1])

    # 2. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
    faiss.normalize_L2(embeddings)

    # 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –≤ –∏–Ω–¥–µ–∫—Å
    index.add(embeddings.astype("float32"))

    logger.info(f"–ü–æ—Å—Ç—Ä–æ–µ–Ω FAISS –∏–Ω–¥–µ–∫—Å —Å {index.ntotal} –≤–µ–∫—Ç–æ—Ä–∞–º–∏")
    return index
```

### –≠—Ç–∞–ø 5: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```python
def save_knowledge_base(self, df: pd.DataFrame, output_file: str) -> None:
    with open(output_file, "w", encoding="utf-8") as f:
        for idx, row in df.iterrows():
            kb_entry = {
                "id": f"q{idx:03d}",                    # –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ID
                "question": row["question"],            # –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å
                "answer": row["answer"],                # –û—Ç–≤–µ—Ç
                "normalized_question": self.normalize_text(row["question"]), # –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –≤–æ–ø—Ä–æ—Å
            }
            f.write(json.dumps(kb_entry, ensure_ascii=False) + "\n")

    logger.info(f"–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ {output_file}")
```

## üöÄ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –ü—Ä–æ—Å—Ç–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ:

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä (–µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω)
pkill -f uvicorn

# 2. –ó–∞–º–µ–Ω–∏—Ç—å Excel —Ñ–∞–π–ª
cp new_faq.xlsx data/faq.xlsx

# 3. –ü–µ—Ä–µ—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω–¥–µ–∫—Å
python build_index.py

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
uvicorn main:app --host 0.0.0.0 --port 8000 &
```

### –°–ª–∏—è–Ω–∏–µ —Ñ–∞–π–ª–æ–≤:

```bash
# 1. –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç —Å–ª–∏—è–Ω–∏—è
cat > merge_excel.py << 'EOF'
import pandas as pd
from pathlib import Path

def merge_excel_files():
    # –ß–∏—Ç–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª
    existing_df = pd.read_excel('data/faq.xlsx')

    # –ß–∏—Ç–∞–µ–º –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã
    new_files = list(Path('incoming').glob('*.xlsx'))

    all_dataframes = [existing_df]

    for file in new_files:
        df = pd.read_excel(file)
        all_dataframes.append(df)

    # –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
    merged_df = pd.concat(all_dataframes, ignore_index=True)

    # –£–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
    merged_df = merged_df.drop_duplicates(subset=['question'])

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π —Ñ–∞–π–ª
    merged_df.to_excel('data/faq_merged.xlsx', index=False)

    print(f"–û–±—ä–µ–¥–∏–Ω–µ–Ω–æ {len(merged_df)} –∑–∞–ø–∏—Å–µ–π")
    return merged_df

if __name__ == "__main__":
    merge_excel_files()
EOF

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª–∏—è–Ω–∏–µ
python merge_excel.py

# 3. –ó–∞–º–µ–Ω–∏—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª
cp data/faq_merged.xlsx data/faq.xlsx

# 4. –ü–µ—Ä–µ—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω–¥–µ–∫—Å
python build_index.py
```

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å:

```bash
#!/bin/bash
# add_excel.sh - –°–∫—Ä–∏–ø—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è Excel —Ñ–∞–π–ª–∞

set -e

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
GREEN='\033[0;32m'
RED='\033[0;31m'
YELLOW='\033[1;33m'
NC='\033[0m'

echo -e "${YELLOW}–î–æ–±–∞–≤–ª–µ–Ω–∏–µ Excel —Ñ–∞–π–ª–∞ –≤ —Å–∏—Å—Ç–µ–º—É FAQ${NC}"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞—Ä–≥—É–º–µ–Ω—Ç—ã
if [ $# -eq 0 ]; then
    echo -e "${RED}–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $0 <–ø—É—Ç—å_–∫_excel_—Ñ–∞–π–ª—É>${NC}"
    exit 1
fi

EXCEL_FILE=$1

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
if [ ! -f "$EXCEL_FILE" ]; then
    echo -e "${RED}–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: $EXCEL_FILE${NC}"
    exit 1
fi

echo -e "${YELLOW}1. –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–µ—Ä–≤–µ—Ä...${NC}"
pkill -f uvicorn || true

echo -e "${YELLOW}2. –°–æ–∑–¥–∞–µ–º –±—ç–∫–∞–ø —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∞–π–ª–∞...${NC}"
if [ -f "data/faq.xlsx" ]; then
    cp data/faq.xlsx "data/faq_backup_$(date +%Y%m%d_%H%M%S).xlsx"
fi

echo -e "${YELLOW}3. –ö–æ–ø–∏—Ä—É–µ–º –Ω–æ–≤—ã–π —Ñ–∞–π–ª...${NC}"
cp "$EXCEL_FILE" data/faq.xlsx

echo -e "${YELLOW}4. –í–∞–ª–∏–¥–∏—Ä—É–µ–º —Ñ–∞–π–ª...${NC}"
python3 -c "
import pandas as pd
try:
    df = pd.read_excel('data/faq.xlsx')
    required_columns = ['question', 'answer']
    missing_columns = [col for col in required_columns if col not in df.columns]

    if missing_columns:
        print(f'‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫–æ–ª–æ–Ω–∫–∏: {missing_columns}')
        exit(1)

    print(f'‚úÖ –§–∞–π–ª –≤–∞–ª–∏–¥–µ–Ω: {len(df)} –∑–∞–ø–∏—Å–µ–π')
except Exception as e:
    print(f'‚ùå –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏: {e}')
    exit(1)
"

if [ $? -ne 0 ]; then
    echo -e "${RED}–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–µ –ø—Ä–æ—à–ª–∞!${NC}"
    exit 1
fi

echo -e "${YELLOW}5. –ü–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∏–Ω–¥–µ–∫—Å...${NC}"
python build_index.py

if [ $? -ne 0 ]; then
    echo -e "${RED}–û—à–∏–±–∫–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞!${NC}"
    exit 1
fi

echo -e "${YELLOW}6. –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä...${NC}"
uvicorn main:app --host 0.0.0.0 --port 8000 &

echo -e "${GREEN}‚úÖ Excel —Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω!${NC}"
echo -e "${GREEN}–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:8000${NC}"
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –õ–æ–≥–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏:

```python
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)

# –ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–æ–≤ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ
INFO - –ü—Ä–æ—á–∏—Ç–∞–Ω —Ñ–∞–π–ª data/faq.xlsx, —Å—Ç—Ä–æ–∫: 200
INFO - –£–¥–∞–ª–µ–Ω–æ 5 –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫
INFO - –£–¥–∞–ª–µ–Ω–æ 3 –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
INFO - –ì–æ—Ç–æ–≤–æ –∫ –æ–±—Ä–∞–±–æ—Ç–∫–µ 192 –∑–∞–ø–∏—Å–µ–π
INFO - –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥–µ–ª—å BAAI/bge-m3...
INFO - –ú–æ–¥–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞
INFO - –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–ª—è 192 —Ç–µ–∫—Å—Ç–æ–≤
INFO - –ü–æ—Å—Ç—Ä–æ–µ–Ω FAISS –∏–Ω–¥–µ–∫—Å —Å 192 –≤–µ–∫—Ç–æ—Ä–∞–º–∏
INFO - FAISS –∏–Ω–¥–µ–∫—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ data/faiss.index
INFO - –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ data/kb.jsonl
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π
python3 -c "
import pandas as pd
import json
import faiss

# Excel —Ñ–∞–π–ª
df = pd.read_excel('data/faq.xlsx')
print(f'Excel –∑–∞–ø–∏—Å–µ–π: {len(df)}')

# JSONL —Ñ–∞–π–ª
with open('data/kb.jsonl', 'r', encoding='utf-8') as f:
    lines = f.readlines()
print(f'JSONL –∑–∞–ø–∏—Å–µ–π: {len(lines)}')

# FAISS –∏–Ω–¥–µ–∫—Å
index = faiss.read_index('data/faiss.index')
print(f'FAISS –≤–µ–∫—Ç–æ—Ä–æ–≤: {index.ntotal}')
"
```

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è:

#### 1. –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω

```python
FileNotFoundError: –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: data/faq.xlsx
```

**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `data/`

#### 2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```python
ValueError: –§–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–ª–æ–Ω–∫–∏: ['question', 'answer']
```

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤—å—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –≤ Excel —Ñ–∞–π–ª

#### 3. –ü—É—Å—Ç–æ–π —Ñ–∞–π–ª

```python
ValueError: –§–∞–π–ª –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã—Ö
```

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ Excel —Ñ–∞–π–ª

#### 4. –û—à–∏–±–∫–∞ –º–æ–¥–µ–ª–∏

```python
RuntimeError: –ú–æ–¥–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞
```

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏

#### 5. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏

```python
MemoryError: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏
```

**–†–µ—à–µ–Ω–∏–µ**: –£–º–µ–Ω—å—à–∏—Ç–µ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –∏–ª–∏ —É–≤–µ–ª–∏—á—å—Ç–µ –ø–∞–º—è—Ç—å

## üéØ –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ** –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤
2. **–£–¥–∞–ª–∏—Ç–µ –¥—É–±–ª–∏–∫–∞—Ç—ã** –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º
3. **–ù–æ—Ä–º–∞–ª–∏–∑—É–π—Ç–µ —Ç–µ–∫—Å—Ç** (—É–±–µ—Ä–∏—Ç–µ –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã)
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–¥–∏—Ä–æ–≤–∫—É** (UTF-8)

### –ü—Ä–æ—Ü–µ—Å—Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:

1. **–°–æ–∑–¥–∞–π—Ç–µ –±—ç–∫–∞–ø** —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
2. **–í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª** –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏** –≤–æ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞–∫–µ—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É** –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
2. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏**
3. **–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**
4. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ –Ω–µ–±–æ–ª—å—à–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö**

## üöÄ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ—Ü–µ—Å—Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è Excel —Ñ–∞–π–ª–∞ –≤–∫–ª—é—á–∞–µ—Ç:

1. **üì• –ü–æ–¥–≥–æ—Ç–æ–≤–∫—É** —Ñ–∞–π–ª–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
2. **üîç –í–∞–ª–∏–¥–∞—Ü–∏—é** –¥–∞–Ω–Ω—ã—Ö –∏ —Ñ–æ—Ä–º–∞—Ç–∞
3. **üîÑ –û–±—Ä–∞–±–æ—Ç–∫—É** —á–µ—Ä–µ–∑ –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä
4. **ü§ñ –ì–µ–Ω–µ—Ä–∞—Ü–∏—é** —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
5. **üóÇÔ∏è –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ** FAISS –∏–Ω–¥–µ–∫—Å–∞
6. **üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
7. **üöÄ –ó–∞–ø—É—Å–∫** –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ!** üéâ
