# ะะธะฐะณัะฐะผะผะฐ ะฟัะพัะตััะฐ ะพะฑัะฐะฑะพัะบะธ Excel ะฑะฐะทั ะดะฐะฝะฝัั

## ๐ ะะพะปะฝัะน ัะธะบะป ะพะฑัะฐะฑะพัะบะธ

```
๐ฅ Excel ัะฐะนะป (data/faq.xlsx)
    โ
๐ ะะฐะปะธะดะฐัะธั ะธ ะพัะธััะบะฐ
    โโโ ะัะพะฒะตัะบะฐ ัััะตััะฒะพะฒะฐะฝะธั ัะฐะนะปะฐ
    โโโ ะัะพะฒะตัะบะฐ ะพะฑัะทะฐัะตะปัะฝัั ะบะพะปะพะฝะพะบ (question, answer)
    โโโ ะฃะดะฐะปะตะฝะธะต ะฟััััั ัััะพะบ
    โโโ ะฃะดะฐะปะตะฝะธะต ะดัะฑะปะธะบะฐัะพะฒ
    โโโ ะะพัะผะฐะปะธะทะฐัะธั ัะตะบััะฐ
    โ
๐ค ะะตะฝะตัะฐัะธั ัะผะฑะตะดะดะธะฝะณะพะฒ
    โโโ ะะฐะณััะทะบะฐ ะผะพะดะตะปะธ BAAI/bge-m3
    โโโ ะะพัะผะฐะปะธะทะฐัะธั ะฒะพะฟัะพัะพะฒ
    โโโ ะะฐะบะตัะฝะฐั ะพะฑัะฐะฑะพัะบะฐ (32 ัะตะบััะฐ ะทะฐ ัะฐะท)
    โโโ ะกะพะทะดะฐะฝะธะต ะฒะตะบัะพัะพะฒ ัะฐะทะผะตัะฝะพััะธ 1024
    โ
๐๏ธ ะะพัััะพะตะฝะธะต FAISS ะธะฝะดะตะบัะฐ
    โโโ ะกะพะทะดะฐะฝะธะต IndexFlatIP
    โโโ L2 ะฝะพัะผะฐะปะธะทะฐัะธั ะฒะตะบัะพัะพะฒ
    โโโ ะะพะฑะฐะฒะปะตะฝะธะต ะฒ ะธะฝะดะตะบั
    โโโ ะกะพััะฐะฝะตะฝะธะต ะฒ data/faiss.index
    โ
๐พ ะกะพััะฐะฝะตะฝะธะต ะฑะฐะทั ะทะฝะฐะฝะธะน
    โโโ ะกะพะทะดะฐะฝะธะต JSONL ัะฐะนะปะฐ
    โโโ ะะพะฑะฐะฒะปะตะฝะธะต ะผะตัะฐะดะฐะฝะฝัั (id, normalized_question)
    โโโ ะกะพััะฐะฝะตะฝะธะต ะฒ data/kb.jsonl
    โ
๐ ะะฝะธัะธะฐะปะธะทะฐัะธั ะฟะพะธัะบะพะฒะพะณะพ ะดะฒะธะถะบะฐ
    โโโ ะะฐะณััะทะบะฐ ะผะพะดะตะปะธ ัะผะฑะตะดะดะธะฝะณะพะฒ
    โโโ ะะฐะณััะทะบะฐ FAISS ะธะฝะดะตะบัะฐ
    โโโ ะะฐะณััะทะบะฐ ะฑะฐะทั ะทะฝะฐะฝะธะน
    โโโ ะะพัะพะฒะฝะพััั ะบ ะฟะพะธัะบั
    โ
๐ ะะพะธัะบ ะพัะฒะตัะพะฒ
    โโโ ะะพัะผะฐะปะธะทะฐัะธั ะทะฐะฟัะพัะฐ ะฟะพะปัะทะพะฒะฐัะตะปั
    โโโ ะะตะฝะตัะฐัะธั ัะผะฑะตะดะดะธะฝะณะฐ ะทะฐะฟัะพัะฐ
    โโโ ะะพะธัะบ ะฒ FAISS ะธะฝะดะตะบัะต
    โโโ ะะฑัะฐะฑะพัะบะฐ ัะตะทัะปััะฐัะพะฒ ะฟะพ ะฟะพัะพะณะฐะผ ัะฒะตัะตะฝะฝะพััะธ
    โโโ ะะพะทะฒัะฐั ะพัะฒะตัะฐ ะฟะพะปัะทะพะฒะฐัะตะปั
```

## ๐ ะะตัะฐะปัะฝะฐั ััะตะผะฐ ะพะฑัะฐะฑะพัะบะธ ะดะฐะฝะฝัั

### ะญัะฐะฟ 1: ะัะพะดะฝัะต ะดะฐะฝะฝัะต

```
Excel ัะฐะนะป (faq.xlsx)
โโโ ะะพะปะพะฝะบะฐ "question" (ะฒะพะฟัะพัั)
โโโ ะะพะปะพะฝะบะฐ "answer" (ะพัะฒะตัั)
โโโ ะะฟัะธะพะฝะฐะปัะฝะฐั ะบะพะปะพะฝะบะฐ "id"
```

### ะญัะฐะฟ 2: ะัะธััะบะฐ ะดะฐะฝะฝัั

```
ะััะพะดะฝัะต ะดะฐะฝะฝัะต
    โ
ะฃะดะฐะปะตะฝะธะต ะฟััััั ัััะพะบ
    โ
ะฃะดะฐะปะตะฝะธะต ะดัะฑะปะธะบะฐัะพะฒ
    โ
ะะพัะผะฐะปะธะทะฐัะธั ัะตะบััะฐ
    โโโ ะัะธะฒะตะดะตะฝะธะต ะบ ะฝะธะถะฝะตะผั ัะตะณะธัััั
    โโโ ะฃะดะฐะปะตะฝะธะต ะปะธัะฝะธั ะฟัะพะฑะตะปะพะฒ
    โโโ ะกัะฐะฝะดะฐััะธะทะฐัะธั ัะพัะผะฐัะฐ
    โ
ะะพัะพะฒัะต ะบ ะพะฑัะฐะฑะพัะบะต ะดะฐะฝะฝัะต
```

### ะญัะฐะฟ 3: ะะตะฝะตัะฐัะธั ัะผะฑะตะดะดะธะฝะณะพะฒ

```
ะขะตะบัั ะฒะพะฟัะพัะฐ
    โ
ะะพะดะตะปั BAAI/bge-m3
    โโโ ะขะพะบะตะฝะธะทะฐัะธั
    โโโ ะะฑัะฐะฑะพัะบะฐ ัะตัะตะท transformer
    โโโ ะกะพะทะดะฐะฝะธะต ะฒะตะบัะพัะฐ ัะฐะทะผะตัะฝะพััะธ 1024
    โ
ะะตะบัะพัะฝะพะต ะฟัะตะดััะฐะฒะปะตะฝะธะต
```

### ะญัะฐะฟ 4: ะะพัััะพะตะฝะธะต ะธะฝะดะตะบัะฐ

```
ะะฐััะธะฒ ัะผะฑะตะดะดะธะฝะณะพะฒ
    โ
FAISS IndexFlatIP
    โโโ L2 ะฝะพัะผะฐะปะธะทะฐัะธั
    โโโ ะะพะฑะฐะฒะปะตะฝะธะต ะฒะตะบัะพัะพะฒ
    โโโ ะะฝะดะตะบัะธัะพะฒะฐะฝะธะต ะดะปั ะฑััััะพะณะพ ะฟะพะธัะบะฐ
    โ
ะะพัะพะฒัะน ะธะฝะดะตะบั (faiss.index)
```

### ะญัะฐะฟ 5: ะกะพััะฐะฝะตะฝะธะต ะฑะฐะทั ะทะฝะฐะฝะธะน

```
DataFrame ั ะดะฐะฝะฝัะผะธ
    โ
JSONL ัะพัะผะฐั
    โโโ ID: q001, q002, q003...
    โโโ question: ะพัะธะณะธะฝะฐะปัะฝัะน ะฒะพะฟัะพั
    โโโ answer: ะพัะฒะตั
    โโโ normalized_question: ะฝะพัะผะฐะปะธะทะพะฒะฐะฝะฝัะน ะฒะพะฟัะพั
    โ
ะคะฐะนะป kb.jsonl
```

## ๐ ะกัะตะผะฐ ะฟะพะธัะบะฐ

### ะัะพัะตัั ะฟะพะธัะบะฐ ะพัะฒะตัะฐ

```
ะะฐะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั
    โ
ะะพัะผะฐะปะธะทะฐัะธั ะทะฐะฟัะพัะฐ
    โ
ะะตะฝะตัะฐัะธั ัะผะฑะตะดะดะธะฝะณะฐ ะทะฐะฟัะพัะฐ
    โ
ะะพะธัะบ ะฒ FAISS ะธะฝะดะตะบัะต
    โโโ ะะพัะธะฝััะฝะพะต ััะพะดััะฒะพ
    โโโ ะขะพะฟ-K ัะตะทัะปััะฐัะพะฒ
    โโโ ะะฝะดะตะบัั ะปัััะธั ัะพะฒะฟะฐะดะตะฝะธะน
    โ
ะะฑัะฐะฑะพัะบะฐ ัะตะทัะปััะฐัะพะฒ
    โโโ confidence โฅ 0.8 โ ะขะพัะฝัะน ะพัะฒะตั
    โโโ 0.6 โค confidence < 0.8 โ ะฃัะพัะฝะตะฝะธะต
    โโโ confidence < 0.6 โ Fallback ะฟัะธะฒะตัััะฒะธะต
    โ
ะัะฒะตั ะฟะพะปัะทะพะฒะฐัะตะปั
```

## ๐ ะัะตะผะตะฝะฝัะต ัะฐัะฐะบัะตัะธััะธะบะธ

### ะัะตะผั ะพะฑัะฐะฑะพัะบะธ (ะดะปั 1000 ะทะฐะฟะธัะตะน):

```
ะงัะตะฝะธะต Excel ัะฐะนะปะฐ:     ~100ms
ะะตะฝะตัะฐัะธั ัะผะฑะตะดะดะธะฝะณะพะฒ:  ~2-5 ัะตะบัะฝะด
ะะพัััะพะตะฝะธะต FAISS:       ~50ms
ะกะพััะฐะฝะตะฝะธะต ัะฐะนะปะพะฒ:      ~20ms
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ะะฑัะตะต ะฒัะตะผั:            ~3-6 ัะตะบัะฝะด
```

### ะัะตะผั ะฟะพะธัะบะฐ:

```
ะะพัะผะฐะปะธะทะฐัะธั ะทะฐะฟัะพัะฐ:   ~1ms
ะะตะฝะตัะฐัะธั ัะผะฑะตะดะดะธะฝะณะฐ:  ~10ms
ะะพะธัะบ ะฒ FAISS:         ~1-5ms
ะะฑัะฐะฑะพัะบะฐ ัะตะทัะปััะฐัะพะฒ: ~1ms
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ะะฑัะตะต ะฒัะตะผั ะฟะพะธัะบะฐ:    ~13-17ms
```

## ๐ฏ ะะพัะพะณะธ ัะฒะตัะตะฝะฝะพััะธ

### ะะพะณะธะบะฐ ะฟัะธะฝััะธั ัะตัะตะฝะธะน:

```
confidence โฅ 0.8
    โ
ะััะพะบะฐั ัะฒะตัะตะฝะฝะพััั
    โโโ ะะพะทะฒัะฐั ัะพัะฝะพะณะพ ะพัะฒะตัะฐ
    โโโ source: q001, q002...
    โโโ similar_questions: []

0.6 โค confidence < 0.8
    โ
ะกัะตะดะฝัั ัะฒะตัะตะฝะฝะพััั
    โโโ ะะฐะฟัะพั ััะพัะฝะตะฝะธั
    โโโ source: null
    โโโ similar_questions: [ัะฟะธัะพะบ ะฟะพัะพะถะธั]

confidence < 0.6
    โ
ะะธะทะบะฐั ัะฒะตัะตะฝะฝะพััั
    โโโ Fallback ะฟัะธะฒะตัััะฒะธะต
    โโโ source: fallback_greeting
    โโโ similar_questions: []
```

## ๐ง ะะพะผะฟะพะฝะตะฝัั ัะธััะตะผั

### ะัะฝะพะฒะฝัะต ะผะพะดัะปะธ:

```
utils/excel_converter.py
โโโ ExcelToVectorDBConverter
โโโ read_excel_file()
โโโ normalize_text()
โโโ generate_embeddings()
โโโ build_faiss_index()
โโโ save_knowledge_base()

utils/search.py
โโโ SearchEngine
โโโ initialize()
โโโ find_best_answer()
โโโ process_search_results()
โโโ load_knowledge_base()

build_index.py
โโโ main() - ัะพัะบะฐ ะฒัะพะดะฐ ะดะปั ะฟะพัััะพะตะฝะธั ะธะฝะดะตะบัะฐ
```

### ะคะฐะนะปั ะดะฐะฝะฝัั:

```
data/
โโโ faq.xlsx          # ะััะพะดะฝัะน Excel ัะฐะนะป
โโโ faiss.index       # FAISS ะธะฝะดะตะบั ะดะปั ะฟะพะธัะบะฐ
โโโ kb.jsonl          # ะะฐะทะฐ ะทะฝะฐะฝะธะน ะฒ JSONL ัะพัะผะฐัะต
โโโ feedback.log      # ะะพะณะธ ะพะฑัะฐัะฝะพะน ัะฒัะทะธ
```

## ๐ ะะตะทัะปััะฐั

ะะพัะปะต ะฟะพะปะฝะพะน ะพะฑัะฐะฑะพัะบะธ Excel ัะฐะนะปะฐ ัะธััะตะผะฐ ะฟะพะปััะฐะตั:

1. **ะะฟัะธะผะธะทะธัะพะฒะฐะฝะฝัะน ะธะฝะดะตะบั** ะดะปั ะฑััััะพะณะพ ะฟะพะธัะบะฐ
2. **ะะตะบัะพัะฝัะต ะฟัะตะดััะฐะฒะปะตะฝะธั** ะฒัะตั ะฒะพะฟัะพัะพะฒ
3. **ะะพัะผะฐะปะธะทะพะฒะฐะฝะฝัั ะฑะฐะทั ะทะฝะฐะฝะธะน** ะฒ JSONL ัะพัะผะฐัะต
4. **ะะพัะพะฒัั ะฟะพะธัะบะพะฒัั ัะธััะตะผั** ะดะปั ะพัะฒะตัะพะฒ ะฟะพะปัะทะพะฒะฐัะตะปัะผ

**ะกะธััะตะผะฐ ะณะพัะพะฒะฐ ะบ ัะฐะฑะพัะต ั ะฒััะพะบะพะน ัะพัะฝะพัััั ะธ ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพัััั!** ๐
